<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Park Crowd Levels</title>
    <link rel="stylesheet" href="styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      /* Styling for the meter */
      .meter {
        display: flex;
        justify-content: space-between;
        width: 300px;
        height: 30px;
        background-color: #e0e0e0;
        border-radius: 15px;
        overflow: hidden;
        margin-top: 20px;
      }
      .segment {
        flex: 1;
        margin: 0 2px;
        background-color: #ddd;
        border-radius: 5px;
      }
      .filled {
        background-color: #4caf50; /* Green for filled segments */
      }
      .info-box {
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Park Crowd Meter</h1>
      <p class="subheading">Check real-time crowd levels at each location</p>
    </header>
    <main>
      <section class="locations">
        <label for="locationSelect">Choose a location:</label>
        <select id="locationSelect">
          <option value="">-- Select a Location --</option>
          <option value="PawPatrol Park">PawPatrol Park</option>
          <!-- Add more locations if needed -->
        </select>
      </section>

      <!-- Info box will hold the meter and other information -->
      <div id="locationInfo" class="info-box" style="display: none">
        <h2>PawPatrol Park</h2>
        <!-- The meter will be displayed here -->
        <div id="dogMeter" class="meter"></div>
        <p><strong>Dog Count:</strong> <span id="dogCount"></span></p>
        <p><strong>Last Updated:</strong> <span id="lastUpdated"></span></p>
      </div>
    </main>

    <script>
      const dropdown = document.getElementById("locationSelect");
      const infoBox = document.getElementById("locationInfo");
      const dogMeter = document.getElementById("dogMeter");
      const dogCount = document.getElementById("dogCount");
      const lastUpdated = document.getElementById("lastUpdated");

      // Hardcoded dog counts for the specific times
      const dogCounts = {
        "9am": 3,
        "10am": 5,
        "11am": 8,
        "12pm": 10,
      };

      // Predefined expected values
      const expectedCounts = {
        "9am": 5,
        "10am": 10,
        "11am": 10,
        "12pm": 10,
      };

      dropdown.addEventListener("change", async function () {
        const value = this.value;
        if (!value) {
          infoBox.style.display = "none";
          return;
        }

        // Get the current time and map it to one of the predefined times
        const currentTime = new Date().getHours(); // Get current hour
        let timeOfDay = "";
        let actualDogCount = 0;
        let expected = 0;

        if (currentTime === 9) {
          timeOfDay = "9am";
          actualDogCount = dogCounts["9am"];
          expected = expectedCounts["9am"];
        } else if (currentTime === 10) {
          timeOfDay = "10am";
          actualDogCount = dogCounts["10am"];
          expected = expectedCounts["10am"];
        } else if (currentTime === 11) {
          timeOfDay = "11am";
          actualDogCount = dogCounts["11am"];
          expected = expectedCounts["11am"];
        } else if (currentTime === 12) {
          timeOfDay = "12pm";
          actualDogCount = dogCounts["12pm"];
          expected = expectedCounts["12pm"];
        } else {
          infoBox.style.display = "block";
          infoBox.innerHTML = `<p>Data is only available for 9am, 10am, 11am, and 12pm. Current time: ${new Date().toLocaleString()}</p>`;
          return;
        }

        // Set dog count and last updated time
        dogCount.textContent = actualDogCount;
        lastUpdated.textContent = new Date().toLocaleString();

        // Calculate the ratio (actual / expected)
        const ratio = Math.min(actualDogCount / expected, 1); // Ensure the ratio doesn't exceed 1
        const highlightedSegments = Math.round(ratio * 10); // Number of segments to fill

        // Create the meter by updating the meter div
        dogMeter.innerHTML = ""; // Clear previous content
        for (let i = 0; i < 10; i++) {
          const segment = document.createElement("div");
          segment.classList.add("segment");
          if (i < highlightedSegments) {
            segment.classList.add("filled"); // Highlight the filled segments
          }
          dogMeter.appendChild(segment);
        }

        infoBox.style.display = "block"; // Show the info box
      });
    </script>
  </body>
</html>


<!-- //         try {
//           const response = await fetch(apiUrl);
//           if (!response.ok) {
//             throw new Error("API error");
//           }

//           const data = await response.json();

//           // Get the actual dog count and timestamp
//           const actual = data.dog_count;
//           const timestamp = new Date(data.timestamp);

//           // Set dog count and last updated time
//           dogCount.textContent = actual;
//           lastUpdated.textContent = timestamp.toLocaleString();

//           // Determine the expected dog count for the selected location (PawPatrol Park)
//           const expected = 10; // Example: Set to 10 (can be dynamic or based on location)

//           // Calculate the ratio (actual / expected)
//           const ratio = Math.min(actual / expected, 1); // Ensure the ratio doesn't exceed 1
//           const highlightedSegments = Math.round(ratio * 10); // Number of segments to fill

//           // Create the meter by updating the meter div
//           dogMeter.innerHTML = ""; // Clear previous content
//           for (let i = 0; i < 10; i++) {
//             const segment = document.createElement("div");
//             segment.classList.add("segment");
//             if (i < highlightedSegments) {
//               segment.classList.add("filled"); // Highlight the filled segments
//             }
//             dogMeter.appendChild(segment);
//           }

//           infoBox.style.display = "block"; // Show the info box
//         } catch (err) {
//           infoBox.style.display = "block";
//           infoBox.innerHTML = `<p style="color:red;">Failed to fetch data: ${err.message}</p>`;
//         }
//       });
//     </script>
//   </body>
// </html> -->


